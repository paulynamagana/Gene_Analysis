---
title: "methylation"
output: pdf_document
always_allow_html: true
---

```{r setup, include=FALSE, eval=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache=TRUE)
```

## Introduction

Load the following packages:


```{r load packages, echo=FALSE}
library(rmarkdown) # paged table
library(GEOquery) #geo query access
library(dplyr)
library(devtools)
library(ggplot2)
library(limma)
library(Glimma)
library(edgeR)
library(kableExtra)
library(ggrepel)
library(tinytex)
Sys.setenv(VROOM_CONNECTION_SIZE = 25600000)

```

## Importing the data

```{r importing, message=FALSE, echo=FALSE}

my_id <- "GSE32866"
gse <- getGEO(my_id)
```

Some datasets on GEO may be derived from different microarray platforms. Therefore the object gse is a list of different datasets. You can find out how many were used by checking the length of the gse object. Usually there will only be one platform and the dataset we want to analyse will be the first object in the list (gse[[1]]).

```{r length, message=FALSE}
length(gse)
```

## Extract the data

```{r length2, message=FALSE}
gse <- gse[[1]]
gse
```

## Exploratory analysis

The `exprs` function can retrieve the expression values as a data frame; with one column per-sample and one row per-gene.

```{r, message=FALSE}
pdata= pData(gse) #sample information
edata= exprs(gse) #expression data
fdata = fData(gse) #gene annotation
```

## Inspect the clinical variables

Data submitted to GEO contain sample labels assigned by the experimenters, and some information about the processing protocol. All these data can be extracted by the pData function.


```{r, message=FALSE}
paged_table(pdata)
```


## Make sure dimensions match up

```{r}
dim(fdata)
```

```{r}
dim(pdata)
```

```{r}
dim(edata)
```

## Look at overall distributions

For visualisation and statistical analysis, we will inspect the data to discover what scale the data are presented in. The methods we will use assume the data are on a log2 scale; typically in the range of 0 to 16.

The `summary` function can then be used to print the distributions.

```{r, message=FALSE}
## exprs get the expression levels as a data frame and get the distribution
kable(summary(exprs(gse)))
```

A boxplot can also be generated to see if the data have been normalised. If so, the distributions of each sample should be highly similar.

```{r, message=FALSE}
boxplot(edata,outline=FALSE)
```







